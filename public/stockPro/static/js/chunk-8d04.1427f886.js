(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-8d04"],{NPAn:function(e,t,o){"use strict";o.r(t);var n=o("ng4Z"),r=o.n(n);for(var s in n)"default"!==s&&function(e){o.d(t,e,function(){return n[e]})}(s);t.default=r.a},ZHYy:function(e,t,o){},gWOR:function(e,t,o){"use strict";o.r(t);var n=o("j3KD"),r=o("NPAn");for(var s in r)"default"!==s&&function(e){o.d(t,e,function(){return r[e]})}(s);o("wBOb");var c=o("KHd+"),a=Object(c.a)(r.default,n.a,n.b,!1,null,null,null);a.options.__file="position.vue",t.default=a.exports},j3KD:function(e,t,o){"use strict";var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"app-container"},[o("div",{staticClass:"filter-container"},[o("el-radio-group",{on:{input:e.changePositionType},model:{value:e.search.ctype,callback:function(t){e.$set(e.search,"ctype",t)},expression:"search.ctype"}},e._l(e.positionTypes,function(t){return o("el-radio-button",{key:t.Code,attrs:{label:t.Code,value:t.Code}},[e._v(e._s(t.Name))])})),e._v(" "),o("div",{staticStyle:{float:"right"}},[o("el-input",{staticClass:"input-with-select",staticStyle:{width:"220px"},attrs:{clearable:"",placeholder:e.$t("Position.StockCode")},model:{value:e.search.stockCode,callback:function(t){e.$set(e.search,"stockCode",t)},expression:"search.stockCode"}})],1)],1),e._v(" "),1==e.search.ctype?o("el-table",{key:e.tableKey,staticClass:"tablebody",attrs:{data:e.StockList.filter(function(t){return""==e.search.stockCode||-1!=t.StockCode.indexOf(e.search.stockCode)}),fit:"","highlight-current-row":"",height:e.tableHeight},on:{"row-click":e.clickTrade}},[o("el-table-column",{attrs:{"header-align":"center",label:e.$t("field.type"),width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(0==t.row.AgreID?e.$t("Position.SpotPosition"):e.getContractName(t.row.AgreID)))])]}}])}),e._v(" "),o("el-table-column",{attrs:{"header-align":"center",label:e.$t("trade.Stock"),width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",{class:["td price",4==t.row.ManyOrNull?"green":""]},[e._v(e._s(t.row.StockName)+"("+e._s(t.row.StockCode)+")")])]}}])}),e._v(" "),o("el-table-column",{attrs:{"header-align":"center",label:e.$t("trade.Quantity"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",{class:["td price",4==t.row.ManyOrNull?"green":""]},[e._v(e._s(t.row.SellNum))])]}}])}),e._v(" "),o("el-table-column",{attrs:{"header-align":"center",label:e.$t("contract.Available"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",{class:["td price",4==t.row.ManyOrNull?"green":""]},[e._v(e._s(t.row.UseNum))])]}}])}),e._v(" "),o("el-table-column",{attrs:{"header-align":"center",label:e.$t("field.cost"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["IX"==t.row.UnitCode?o("span",{class:t.row.OnePrice-e.stocks[t.row.StockCode]>0?0==e.RedUpGreenDown?"red":"green":1==e.RedUpGreenDown?"red":"green"},[e._v(e._s(t.row.OnePrice.toFixed(t.row.PriceDecimal)))]):o("div",[1==e.costcalculation?o("span",{class:t.row.SellPrice/t.row.SellNum-e.stocks[t.row.StockCode]>0?0==e.RedUpGreenDown?"red":"green":1==e.RedUpGreenDown?"red":"green"},[e._v(e._s((t.row.SellPrice/t.row.SellNum).toFixed(t.row.PriceDecimal)))]):o("span",{class:t.row.ThisTimePrice/t.row.SellNum-e.stocks[t.row.StockCode]>0?0==e.RedUpGreenDown?"red":"green":1==e.RedUpGreenDown?"red":"green"},[e._v(e._s((t.row.ThisTimePrice/t.row.SellNum).toFixed(t.row.PriceDecimal)))])])]}}])}),e._v(" "),o("el-table-column",{attrs:{"header-align":"center",label:e.$t("field.curPrice"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",{class:e.stocksD[t.row.StockCode+"c"]},[e._v(e._s(e.stocks[t.row.StockCode]))])]}}])}),e._v(" "),o("el-table-column",{attrs:{"header-align":"center",label:e.$t("field.profit"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["IX"==t.row.UnitCode?o("span",{class:e.stocks[t.row.StockCode]-t.row.OnePrice>0?1==e.RedUpGreenDown?"red":"green":0==e.RedUpGreenDown?"red":"green"},[e._v(e._s(4==t.row.ManyOrNull?((t.row.OnePrice-e.stocks[t.row.StockCode])*t.row.SellNum*30).toFixed(2):((e.stocks[t.row.StockCode]-t.row.OnePrice)*t.row.SellNum*30).toFixed(t.row.PriceDecimal)))]):o("div",[1==e.costcalculation?o("span",{class:["padleft",t.row.SellNum*e.stocks[t.row.StockCode]-t.row.SellPrice>0?1==e.RedUpGreenDown?"red":"green":0==e.RedUpGreenDown?"red":"green"]},[e._v(e._s(4==t.row.ManyOrNull?(t.row.SellPrice-t.row.SellNum*e.stocks[t.row.StockCode]).toFixed(2):(t.row.SellNum*e.stocks[t.row.StockCode]-t.row.SellPrice).toFixed(2)))]):o("span",{class:["padleft",t.row.SellNum*e.stocks[t.row.StockCode]-t.row.ThisTimePrice>0?1==e.RedUpGreenDown?"red":"green":0==e.RedUpGreenDown?"red":"green"]},[e._v(e._s(4==t.row.ManyOrNull?(t.row.ThisTimePrice-t.row.SellNum*e.stocks[t.row.StockCode]).toFixed(2):(t.row.SellNum*e.stocks[t.row.StockCode]-t.row.ThisTimePrice).toFixed(2)))])])]}}])}),e._v(" "),o("el-table-column",{attrs:{"header-align":"center",label:e.$t("field.upRate"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",{class:["padleft",e.stocksD[t.row.StockCode+"c"]]},[e._v(e._s(e.stocksD[t.row.StockCode+"b"]))])]}}])}),e._v(" "),o("el-table-column",{attrs:{"header-align":"center",label:e.$t("contract.PositionMarket"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==e.costcalculation?o("span",[e._v(e._s(4==t.row.ManyOrNull?(t.row.SellNum*e.stocks[t.row.StockCode]+2*(t.row.SellPrice-t.row.SellNum*e.stocks[t.row.StockCode])).toFixed(2):(t.row.SellNum*e.stocks[t.row.StockCode]).toFixed(2))+" "+e._s(e.$t("contract.Coin"+t.row.CoinType)))]):o("span",[e._v(e._s(4==t.row.ManyOrNull?(t.row.SellNum*e.stocks[t.row.StockCode]+2*(t.row.ThisTimePrice-t.row.SellNum*e.stocks[t.row.StockCode])).toFixed(2):(t.row.SellNum*e.stocks[t.row.StockCode]).toFixed(2))+" "+e._s(e.$t("contract.Coin"+t.row.CoinType)))])]}}])})],1):o("el-table",{key:e.tableKey,staticClass:"tablebody",attrs:{data:e.EntrustList.filter(function(t){return""==e.search.stockCode||t.StockCode==e.search.stockCode}),fit:"","highlight-current-row":"",height:e.tableHeight}},[o("el-table-column",{attrs:{"header-align":"center",label:e.$t("trade.Stock"),width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(t.row.StockName)+"("+e._s(t.row.StockCode)+")")])]}}])}),e._v(" "),o("el-table-column",{attrs:{"header-align":"center",label:e.$t("details.DeleTime"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(t.row.DelegationDate))])]}}])}),e._v(" "),o("el-table-column",{attrs:{"header-align":"center",label:e.$t("trade.CommissionPrice"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(t.row.DelegationPrice))]),e._v(" "),o("span",[e._v(e._s(e.$t("trade.EntrustPrice",{coin:e.$t("contract.Coin"+t.row.CoinType)})))])]}}])}),e._v(" "),o("el-table-column",{attrs:{"header-align":"center",label:e.$t("trade.Quantity"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(t.row.DelegationNum))])]}}])}),e._v(" "),o("el-table-column",{attrs:{"header-align":"center",label:e.$t("field.type"),width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.DelegationType?o("span",{staticClass:"red"},[e._v(e._s(e.$t("trade.EntrustBuy")))]):2==t.row.DelegationType?o("span",{staticClass:"green"},[e._v(e._s(e.$t("trade.EntrustSell")))]):3==t.row.DelegationType?o("span",{staticClass:"red"},[e._v(e._s(e.$t("trade.BuyLong")))]):4==t.row.DelegationType?o("span",{staticClass:"green"},[e._v(e._s(e.$t("trade.SellShort")))]):5==t.row.DelegationType?o("span",{staticClass:"red"},[e._v(e._s(e.$t("trade.BuyEmpty")))]):6==t.row.DelegationType?o("span",{staticClass:"green"},[e._v(e._s(e.$t("trade.SellPindo")))]):10==t.row.DelegationType||11==t.row.DelegationType?o("span",{staticClass:"green"},[e._v(e._s(e.$t("trade.SellQP")))]):e._e()]}}])}),e._v(" "),o("el-table-column",{attrs:{"header-align":"center",label:e.$t("trade.ActualTransaction"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(t.row.DealNum))])]}}])}),e._v(" "),o("el-table-column",{attrs:{"header-align":"center",label:e.$t("field.op"),width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.IsOver?e._e():o("el-button",{staticClass:"cancel",attrs:{type:"text",size:"mini"},on:{click:function(o){e.cancelDele(t.row)}}},[e._v(e._s(e.$t("trade.Revoke")))])]}}])})],1)],1)},r=[];o.d(t,"a",function(){return n}),o.d(t,"b",function(){return r})},ng4Z:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(o("7bS+")),r=s(o("nv1Z"));function s(e){return e&&e.__esModule?e:{default:e}}t.default={name:"Position",directives:{},components:{},mixins:[n.default],filters:{},data:function(){return{positionTypes:[{Code:1,Name:this.$t("trade.Position")},{Code:2,Name:this.$t("trade.CurrentCommission")}],search:{ctype:1,stockCode:"",UID:0},item:{},rules:{},userinfo:r.default.getUsers(),costcalculation:r.default.getCostCalculation(),RedUpGreenDown:r.default.getRedUpGreenDown(),ContractList:[],StockList:[],EntrustList:[],stocks:{},stocksD:{},pageKey:"Position",pageName:this.$t("route.position")}},mounted:function(){var e=this;setTimeout(function(){e.initPageData()},500)},computed:{},created:function(){},methods:{cancelDele:function(e){var t=this,o=this,n=r.default.md5.hex_md5(e.StockCode+"|"+e.id+"|"+e.AgreID+"|"+this.userinfo.id);this.$confirm(this.$t("msg.SubmitCanceInfo",{name:e.StockName,code:e.StockCode}),this.$t("msg.SubmitCancellation"),{confirmButtonText:this.$t("btn.Confirm"),cancelButtonText:this.$t("btn.Cancel"),type:"warning"}).then(function(){r.default.socket.emit("cancellations",{did:e.id,aid:e.AgreID,uid:t.userinfo.id,code:e.StockCode,cc:n}),o.getList()}).catch(function(){})},getContractName:function(e){var t=this.ContractList.filter(function(t){return t.id==e});return t.length>0?t[0].AgreName:e},clickTrade:function(e){if(null!=e){var t=e.StockCode||e.c,o=e.StockName||e.n,n=e.MarketCode||e.m,s=t.split("."),c=s[1],a=s[0],i=this.stocksD[c+"c"],l=this.stocksD[c+"y"],d=void 0==e.StockType?e.CoinType:e.StockType;if(void 0==d&&(d="CNY"==this.curCoinCode?0:"HKD"==this.curCoinCode?1:2),void 0==n)if("SZ"==a)n="0";else if("SH"==a)n="1";else{var u=localStockList.filter(function(e){return e.c==t});u.length>0&&(n=u[0].m)}var f=c+"_"+n+"."+a.toLowerCase().replace("us","usa");"USDT"==a&&(f=c+"."+a.toLowerCase()),r.default.setTradeStock({StockCode:t,StockName:o,CoinType:d,aid:e.AgreID||0,sellbuy:2});var k="HK"==a||"US"==a?3:"SH"==a||"SZ"==a?2:"USDT"==a?e.DecimalPrice||e.PriceDecimal:0,p="USDT"==a?e.DecimalNum||e.NumDecimal:0;this.$router.push({path:"/stock",query:{code:t,name:o,price:k,symbol:f,market:n,num:p,px:a,c:i,y:l,t:(new Date).getTime()}}),this.$bus.$emit("stockChanged",{stockcode:t,stockname:o})}},getList:function(){var e=this,t=1==this.search.ctype?"GetMyContractStockList":"GetMyEntrustList",o={UID:this.userinfo.id,useracc:this.userinfo.UserAcc};r.default.Ajax("Contract/"+t,o,e.userinfo.Token,function(t,o){t?e.$message.error(e.$t("msg."+t)):(console.log("that.search:",e.search),1==e.search.ctype?(e.ContractList=o.AgreList,e.StockList=o.StockList,e.userinfo.HaveMoney=o.HaveMoney,r.default.addUser(e.userinfo),o.StockList.forEach(function(t){e.stocks[t.StockCode]||(e.stocks[t.StockCode]="--")})):(e.EntrustList=o,o.forEach(function(t){e.stocks[t.StockCode]||(e.stocks[t.StockCode]="--")})),e.addStockListerers())})},changePositionType:function(){this.getList()},initPageData:function(){var e=this;this.$nextTick(function(){e.getList()})},addStockListerers:function(){var e=this,t=e.userinfo.UserAcc||"system"+(new Date).getTime(),o=r.default.md5.hex_md5(t+"|"+(new Date).getMonth());r.default.socket.emit("handshake",{user:t,token:o}),r.default.socket.on("handshake",function(t){if(1==t.stat){var o=[];for(var n in e.stocks)o.push({code:n});o.length>0&&setTimeout(function(){r.default.socket.emit("selfstock",{stat:0,stocks:o})},50)}});var n=function(t){if(t.c){var o=t.c;"SH.600001"==o&&(o="SH.000001");var n=1;"SH"!=o.split(".")[0]&&"SZ"!=o.split(".")[0]||(n=1e3);var r=e.StockList.filter(function(e){return e.StockCode==o}),s=e.decimalNum;r.length>0&&(s=r[0].PriceDecimal);var c=parseFloat(t.p)/n,a=parseFloat(t.y)/n,i=(c-a)/a*100;e.$set(e.stocks,o,c.toFixed(s)),e.$set(e.stocksD,o+"y",(t.y/n).toFixed(s)),e.$set(e.stocksD,o+"b",i.toFixed(2)+"%"),e.$set(e.stocksD,o+"c",i>0&&1==e.RedUpGreenDown||i<0&&0==e.RedUpGreenDown?"red":0==i?"":"green"),e.$set(e.stocksD,o+"u",(t.u/n).toFixed(s)),e.$set(e.stocksD,o+"d",(t.d/n).toFixed(s))}},s=function(t){if(t.c){var o=t.c;"SH.600001"==o&&(o="SH.000001");var n=1;"SH"!=o.split(".")[0]&&"SZ"!=o.split(".")[0]||(n=1e3);var r=e.StockList.filter(function(e){return e.StockCode==o}),s=e.decimalNum;r.length>0&&(s=r[0].PriceDecimal);var c=t.p/n,a=+e.stocksD[o+"y"],i=(c-a)/a*100;e.$set(e.stocks,o,c.toFixed(s)),e.$set(e.stocksD,o+"b",i.toFixed(2)+"%"),e.$set(e.stocksD,o+"c",i>0&&1==e.RedUpGreenDown||i<0&&0==e.RedUpGreenDown?"red":0==i?"":"green")}};r.default.socket.off("selfstock",n),r.default.socket.on("selfstock",n),r.default.socket.off("selfstock",s),r.default.socket.on("price",s);var c=function(t){setTimeout(function(){e.loadMyEntrust(),uni.showToast({title:e.$t("msg.SuccessDeal",{code:t}),icon:"none"})},1e3)};r.default.socket.off("deal",c),r.default.socket.on("deal",c);var a=function(t){1!=t.t&&2!=t.t?(e.$alert(e.$t("msg."+t.m),e.$t("msg.Tip")),e.EntrustList.filter(function(e){return e.id==t.d}).forEach(function(e){e.IsOver=!0,e.IsCallback=!0})):e.$message.success(e.$t("msg."+t.m))};r.default.socket.off("cancellations",a),r.default.socket.on("cancellations",a)}}}},wBOb:function(e,t,o){"use strict";var n=o("ZHYy");o.n(n).a}}]);